<!DOCTYPE html>
<html lang="ja">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JL8DFLM6C5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-JL8DFLM6C5');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>PITA診断 | あなたは何主義者として生きるのか。</title>
    <meta name="description" content="100の質問があなたの魂の形を決定づける。深層に潜む『イズム』を解剖する精密診断システム。">
    <link rel="canonical" href="https://pita-diagnosis.com/">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@700&family=Noto+Sans+JP:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #111111; --accent: #3b82f6; --bg-gray: #f3f4f6; }
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #ffffff; color: var(--primary); -webkit-font-smoothing: antialiased; overflow-x: hidden; word-break: break-word; }
        .serif { font-family: 'Noto Serif JP', serif; }
        
        .btn-choice { transition: all 0.2s ease-out; border: 1px solid #eeeeee; background: #ffffff; cursor: pointer; -webkit-tap-highlight-color: transparent; }
        .btn-choice:hover { border-color: var(--accent); background: #fafdff; transform: translateY(-1px); }
        .btn-choice:active { transform: scale(0.98); background: #f9f9f9; }
        
        .btn-secondary { transition: all 0.2s; border: 1px solid #e5e7eb; background: #fff; }
        .btn-secondary:hover { border-color: var(--accent); color: var(--accent); }

        .btn-back { transition: all 0.2s; color: #999; }
        .btn-back:hover { color: var(--primary); text-decoration: underline; }
        
        .progress-bar { transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .img-slot { aspect-ratio: 1 / 1; width: 100%; max-width: 320px; margin: 0 auto; border-radius: 50%; background-color: var(--bg-gray); overflow: hidden; display: flex; align-items: center; justify-content: center; position: relative; border: 1px solid #eeeeee; }
        
        .result-img { opacity: 0; transition: opacity 1.2s ease-in-out; width: 100%; height: 100%; object-fit: cover; }
        .img-loaded .result-img { opacity: 1; }
        .list-img { width: 100%; height: 100%; object-fit: cover; display: block; opacity: 1 !important; }

        .img-placeholder { font-weight: 900; font-size: 0.6rem; color: #cccccc; letter-spacing: 0.1em; text-transform: uppercase; }

        .ticker-container { width: 100%; overflow: hidden; white-space: nowrap; background: #fafafa; padding: 20px 0; border-top: 1px solid #eee; border-bottom: 1px solid #eee; margin-bottom: 2px; }
        .ticker-content { display: inline-block; animation: ticker 80s linear infinite; will-change: transform; }
        @keyframes ticker { from { transform: translate3d(0,0,0); } to { transform: translate3d(-33.333%,0,0); } }
        .ticker-item { display: inline-block; margin: 0 30px; font-weight: 700; color: #888; font-size: 0.9rem; }
        .ticker-char { color: var(--accent); opacity: 0.8; }

        .ism-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 1rem; }
        .ism-card { background: #fff; border: 1px solid #f0f0f0; border-radius: 1.5rem; padding: 1.5rem 1rem; transition: all 0.3s; text-align: center; }
        .ism-card:hover { border-color: var(--accent); transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.05); }

        .hidden { display: none; }
        .fade-in { animation: fadeIn 1s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        .text-balance { text-wrap: balance; }

        #dev-menu { position: fixed; top: 10%; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; background: #111; color: white; padding: 2rem; border-radius: 1.5rem; z-index: 1000; box-shadow: 0 20px 50px rgba(0,0,0,0.5); border: 1px solid #333; }
    </style>
</head>
<body class="min-h-screen flex flex-col bg-white text-left">

    <!-- Header -->
    <nav class="p-4 md:p-8 flex justify-between items-center border-b border-gray-50 bg-white/80 backdrop-blur-md sticky top-0 z-50">
        <div class="flex flex-col cursor-pointer select-none text-left" onclick="devClick()">
            <div class="text-2xl md:text-3xl font-black tracking-tighter serif text-gray-900 leading-none">PITA</div>
            <div class="text-[7px] md:text-[8px] font-bold text-gray-400 tracking-[0.15em] uppercase mt-1 leading-none">Personality Ism Type Analyzer</div>
        </div>
        <div class="text-[9px] font-bold text-blue-600 tracking-widest uppercase italic border-l pl-4 border-gray-100 text-right">Core v6.2</div>
    </nav>

    <!-- Developer Menu -->
    <div id="dev-menu" class="hidden">
        <p class="mb-4 font-bold border-b border-gray-700 pb-2 text-blue-400 uppercase text-xs text-center">Debug Preview</p>
        <div class="grid grid-cols-2 gap-2 text-center text-xs">
            <button onclick="jumpToResult('ALT')" class="p-2 bg-gray-800 rounded">利他</button>
            <button onclick="jumpToResult('EGO')" class="p-2 bg-gray-800 rounded">利己</button>
            <button onclick="jumpToResult('OPT')" class="p-2 bg-gray-800 rounded">楽観</button>
            <button onclick="jumpToResult('NIH')" class="p-2 bg-gray-800 rounded">虚無</button>
            <button onclick="jumpToResult('IDE')" class="p-2 bg-gray-800 rounded">理想</button>
            <button onclick="jumpToResult('REA')" class="p-2 bg-gray-800 rounded">現実</button>
            <button onclick="jumpToResult('MOD')" class="p-2 bg-gray-800 rounded">秩序</button>
            <button onclick="jumpToResult('ANA')" class="p-2 bg-gray-800 rounded">混沌</button>
        </div>
        <button class="mt-6 w-full text-red-400 font-bold border border-red-900/30 p-2 rounded" onclick="document.getElementById('dev-menu').classList.add('hidden')">CLOSE</button>
    </div>

    <main class="flex-grow flex flex-col items-center justify-start p-4 md:p-6 bg-[#fcfcfc]">
        
        <!-- Intro Screen -->
        <div id="intro" class="max-w-4xl w-full text-center fade-in py-8">
            <div class="mb-4 inline-block px-4 py-1 rounded-full border border-gray-100 text-[9px] font-black tracking-widest text-gray-400 uppercase text-center">
                Identity Structure Verification
            </div>
            <h2 class="text-3xl md:text-7xl font-bold mb-8 serif leading-tight text-gray-900 text-center text-balance">
                あなたは何主義者として<br><span class="text-blue-600">生きるのか。</span>
            </h2>
            <p class="text-gray-500 mb-10 leading-relaxed text-xs md:text-sm tracking-widest max-w-lg mx-auto px-4 text-center text-balance">
                日常に潜む100の分岐点。その無意識の選択の重みが、あなたの主義を定義する。
            </p>
            
            <div class="mb-16 px-4 text-center">
                <button onclick="startDiagnosis()" class="w-full md:w-auto group relative inline-block text-center mx-auto">
                    <div class="absolute inset-0 bg-blue-600 rounded-full blur-2xl opacity-10 group-hover:opacity-30 transition"></div>
                    <div class="relative bg-gray-900 text-white px-16 py-6 rounded-full font-bold text-xl transition-all group-hover:bg-blue-700 shadow-2xl">
                        診断を開始する（全100問）
                    </div>
                </button>
                <div class="mt-8 text-center">
                    <button onclick="showView('guide')" class="text-[10px] font-bold text-gray-400 hover:text-blue-500 transition-colors uppercase tracking-widest border-b border-gray-200 hover:border-blue-200 pb-1">
                        初めての方はこちら
                    </button>
                </div>
            </div>

            <div class="w-full bg-white rounded-[3rem] p-8 md:p-12 shadow-sm border border-gray-50 text-left text-balance">
                <h3 class="text-[10px] font-black tracking-[0.4em] mb-10 text-gray-300 uppercase italic text-center">8 Types of Soul Architecture</h3>
                <div class="ism-grid" id="ism-intro-grid"></div>
            </div>
        </div>

        <!-- Guide View -->
        <div id="guide" class="max-w-2xl w-full hidden fade-in py-12 px-4 text-left text-balance">
            <button onclick="showView('intro')" class="mb-8 text-gray-400 hover:text-black font-bold text-[10px] uppercase tracking-widest flex items-center gap-2">
                <span>← BACK</span>
            </button>
            <div class="bg-white p-8 md:p-12 rounded-[2rem] shadow-sm border border-gray-50">
                <h2 class="text-2xl md:text-4xl font-bold mb-10 serif border-b pb-6 text-center text-balance">初めての方へ：PITAの楽しみ方</h2>
                
                <section class="mb-12">
                    <h3 class="text-xs font-black text-blue-600 uppercase tracking-widest mb-6 border-l-4 border-blue-600 pl-3">01. PITA診断の楽しみ方</h3>
                    <div class="space-y-4 text-sm leading-relaxed text-gray-600">
                        <p>・<strong>直感に従う：</strong> 100の質問に対し、深く考えすぎず、直感でパッと答えてください。その迷いこそがあなたの深層心理を映し出します。</p>
                        <p>・<strong>自分の「イズム」を知る：</strong> 結果画面では、あなたの価値観のバランスを可視化します。特定の主義に特化しているか、あるいは複数の主義が調和しているかを確認しましょう。</p>
                        <p>・<strong>シェアして比較する：</strong> 結果を友人や同僚とシェアし、お互いの「主義」の違いを比べることで、コミュニケーションの新しい視点が得られます。</p>
                    </div>
                </section>

                <section class="mb-12 text-left">
                    <h3 class="text-xs font-black text-blue-600 uppercase tracking-widest mb-6 border-l-4 border-blue-600 pl-3">02. 8つのイズムと相反する指標</h3>
                    <div class="space-y-4 text-sm leading-relaxed text-gray-600">
                        <p>PITAは以下の4つの軸、計8つの相反する指標で構成されています。</p>
                        <ul class="space-y-2 pl-4 border-l-2 border-blue-50">
                            <li><strong>献身 (利他主義者) vs 孤高 (利己主義者)</strong></li>
                            <li><strong>渇望 (楽観主義者) vs 静観 (虚無主義者)</strong></li>
                            <li><strong>夢幻 (理想主義者) vs 実利 (現実主義者)</strong></li>
                            <li><strong>調和 (秩序主義者) vs 変革 (混沌主義者)</strong></li>
                        </ul>
                    </div>
                </section>

                <section class="mb-12 text-left">
                    <h3 class="text-xs font-black text-blue-600 uppercase tracking-widest mb-6 border-l-4 border-blue-600 pl-3">03. 診断結果の種類</h3>
                    <div class="text-sm leading-relaxed text-gray-600">
                        <p>診断後、あなたは最も強く現れた指標に基づき、8つのタイプ（利他主義者・利己主義者・楽観主義者・虚無主義者・理想主義者・現実主義者・秩序主義者・混沌主義者）のいずれかに分類されます。</p>
                    </div>
                </section>

                <section class="mb-12 p-6 bg-slate-50 rounded-2xl border border-slate-100 text-center">
                    <p class="text-xs text-gray-500 mb-4 font-bold tracking-tight">診断を開始する前に、プライバシーポリシーもお読みください。</p>
                    <a href="privacy.html" target="_self" class="text-xs font-bold text-blue-600 border-b border-blue-200 pb-0.5 hover:text-blue-800 transition">PRIVACY POLICY</a>
                </section>

                <div class="mt-8 text-center">
                    <button onclick="startDiagnosis()" class="bg-gray-900 text-white px-10 py-4 rounded-full font-bold text-sm hover:bg-blue-600 transition shadow-lg">
                        理解したので診断を始める
                    </button>
                </div>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz" class="max-w-2xl w-full hidden py-4 md:py-16 text-left text-balance">
            <div class="mb-10 md:mb-16 px-2 text-left">
                <div class="w-full bg-gray-100 h-[2px] mb-6 text-left"><div id="progress" class="progress-bar bg-blue-600 h-full text-left" style="width: 1%"></div></div>
                <div class="flex justify-between items-end text-left h-10">
                    <div class="flex flex-col text-left">
                        <span id="q-hint" class="text-[10px] font-bold text-blue-500 italic mb-1 h-4 select-none text-left">...</span>
                        <span id="q-count" class="text-[9px] font-black text-gray-400 tracking-widest uppercase text-left">Question 01</span>
                    </div>
                    <div class="text-right">
                        <div id="q-percent" class="text-3xl md:text-4xl font-light text-blue-600 serif leading-none">1%</div>
                    </div>
                </div>
            </div>
            <div class="min-h-[160px] md:min-h-[200px] flex flex-col items-center justify-center mb-12 px-2 text-center">
                <h3 id="question-text" class="text-xl md:text-3xl font-bold leading-relaxed serif text-gray-800 text-center text-balance"></h3>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-lg mx-auto px-4 mb-8">
                <button onclick="answer(true)" class="btn-choice py-6 md:py-8 px-6 rounded-2xl font-bold text-gray-800 text-lg md:text-xl shadow-sm text-center">はい</button>
                <button onclick="answer(false)" class="btn-choice py-6 md:py-8 px-6 rounded-2xl font-bold text-gray-800 text-lg md:text-xl shadow-sm text-center">いいえ</button>
            </div>
            <div class="text-center">
                <button id="btn-back" onclick="goBack()" class="btn-back text-[10px] font-bold uppercase tracking-widest hidden w-full text-center text-balance">← ひとつ前の質問に戻る</button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result" class="max-w-4xl w-full hidden fade-in py-12 text-center">
            <div class="text-center mb-16 px-4 mx-auto">
                <p class="text-[9px] font-black text-blue-600 uppercase tracking-[0.6em] mb-4 text-center text-balance">Diagnostic Complete</p>
                <h2 id="result-title" class="text-4xl md:text-7xl font-bold mb-1 serif tracking-tighter text-gray-900 text-center text-balance"></h2>
                <p id="result-en" class="text-[12px] font-black text-gray-300 uppercase tracking-[0.4em] mb-6 italic text-center"></p>
                <p id="result-catch" class="text-lg md:text-2xl text-gray-400 font-medium italic serif mb-10 text-center text-balance"></p>
                <div id="result-art-container" class="img-slot shadow-2xl bg-white mb-12 border-none scale-100 md:scale-110 mx-auto"></div>
                <div class="inline-flex flex-col items-center bg-white px-8 py-6 rounded-[2rem] border border-gray-100 shadow-sm relative mx-auto text-center text-balance">
                    <div class="text-[8px] md:text-[9px] text-gray-400 uppercase font-black mb-1 tracking-[0.4em] text-center text-balance">Deep PITA Index</div>
                    <div class="flex items-baseline gap-2 justify-center">
                        <div id="stat-1" class="text-4xl md:text-6xl font-black italic tracking-tighter text-blue-900 text-center"></div>
                        <div class="text-[10px] font-bold text-gray-300 text-center">/ 200.0</div>
                    </div>
                </div>
            </div>

            <div class="space-y-24 md:space-y-32 text-center mx-auto">
                <section class="max-w-2xl mx-auto px-6 text-center">
                    <h4 class="text-[9px] font-bold text-gray-300 mb-10 uppercase tracking-[0.5em] italic text-center text-balance">Spectrum Balance</h4>
                    <div id="axis-details" class="space-y-10 md:space-y-12"></div>
                </section>
                <section class="border-t border-gray-100 pt-20 overflow-hidden text-center">
                    <h4 class="text-[9px] font-bold text-gray-400 mb-8 uppercase tracking-[0.5em] italic text-center text-balance">Parallel Souls (Historical)</h4>
                    <div class="ticker-container"><div id="ticker-content" class="ticker-content"></div></div>
                </section>
                <section class="border-t border-gray-100 pt-16 overflow-hidden text-center">
                    <h4 class="text-[9px] font-bold text-blue-400 mb-8 uppercase tracking-[0.5em] italic text-center text-balance">Modern Icons (Characters)</h4>
                    <div class="ticker-container"><div id="ticker-char-content" class="ticker-content"></div></div>
                </section>
                <section class="bg-white p-8 md:p-24 rounded-[3rem] md:rounded-[5rem] mx-4 shadow-sm border border-gray-50 text-left text-gray-700 text-balance">
                    <h4 class="text-[9px] font-bold text-gray-300 mb-10 uppercase tracking-[0.5em] text-center italic text-center text-balance">Identity Report</h4>
                    <div id="result-desc" class="leading-relaxed md:leading-[2.8] text-base md:text-xl space-y-12 serif text-left"></div>
                </section>
                <section class="bg-blue-600 text-white p-8 md:p-24 rounded-[3rem] md:rounded-[5rem] shadow-2xl relative overflow-hidden mx-4 text-center">
                    <h4 class="text-[9px] font-bold text-blue-200 mb-10 uppercase tracking-[0.6em] text-center relative z-10 text-center text-balance">Future Guidance</h4>
                    <div id="result-direction" class="text-blue-50 leading-relaxed md:leading-[2.6] text-base md:text-xl space-y-10 relative z-10 text-center mx-auto max-w-lg text-balance"></div>
                </section>
                <div class="flex flex-col gap-6 pt-12 text-center pb-24 px-6 mx-auto max-w-sm text-center text-balance">
                    <button onclick="shareOnX()" class="bg-[#1DA1F2] text-white py-5 px-10 rounded-full font-bold text-lg hover:opacity-90 transition-all shadow-xl text-center w-full text-white">結果をXでシェアする</button>
                    <a href="https://forms.gle/d6nJr3NhzWkyTiQFA" target="_blank" class="btn-secondary text-gray-700 py-5 px-10 rounded-full font-bold text-lg text-center w-full flex items-center justify-center gap-2 text-gray-700 transition"><span>フィードバックを送る</span></a>
                    <button onclick="location.reload()" class="bg-gray-900 text-white py-5 px-10 rounded-full font-bold text-lg hover:bg-black transition-all shadow-md text-center w-full text-white">もう一度診断する</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="p-16 text-center border-t border-gray-50 bg-white">
        <div class="flex flex-wrap justify-center gap-x-8 gap-y-4 mb-8 text-[10px] font-bold text-gray-400 uppercase tracking-[0.2em] select-none text-center text-balance">
            <button onclick="showView('guide')" class="hover:text-blue-500 transition-colors">GUIDE</button>
            <a href="https://forms.gle/d6nJr3NhzWkyTiQFA" target="_blank" class="hover:text-blue-500 transition-colors">CONTACT</a>
            <a href="privacy.html" class="hover:text-blue-500 transition-colors">PRIVACY POLICY</a>
        </div>
        <div class="text-[9px] text-gray-300 uppercase tracking-[0.4em] mb-2 font-bold italic text-center">PITA / Personality Ism Type Analyzer</div>
        <div class="text-[7px] text-gray-200 tracking-tighter mt-4 text-center">&copy; 2026 pita-diagnosis.com. All rights reserved.</div>
    </footer>

    <script>
        // --- データ定義 ---
        const resultData = {
            ALT: { 
                en: "ALT", k: "アルトルイスト", n: "利他主義者", c: "「時代を救済する慈愛の聖者」", img: "PITA-ALT.png", 
                celebs: ["マザー-テレサ", "ガンジー", "シュバイツァー", "ナイチンゲール", "キング牧師", "デスモンド-ツツ", "ダイアナ妃", "ヘレン-ケラー", "杉原千畝", "新渡戸稲造", "孔子", "ソクラテス", "アリストテレス", "プラトン", "リンカーン", "聖徳太子", "宮沢賢治", "ジャンヌ-ダルク", "アンネ-フランク", "ヘンリー-デュナン", "緒方貞子", "ペスタロッチ", "渋沢栄一", "ジョン-ラスキン", "トマ-ピケティ", "カント", "ヘーゲル", "ハイデガー", "アインシュタイン", "チャップリン"],
                chars: ["竈門炭治郎(鬼滅)", "緑谷出久(ヒロアカ)", "沢田綱吉(REBORN)", "ベル・クラネル(ダンまち)", "夏目貴志(夏目友人帳)", "乙骨憂太(呪術)", "竈門禰󠄀豆子(鬼滅)", "藤丸立香(FGO)", "アルフォンス(ハガレン)", "潮田渚(暗殺教室)", "アレン・ウォーカー(D.Gray-man)", "花垣武道(東リベ)", "有馬かな(【推しの子】)", "黒子テツヤ(黒バス)", "澤村大地(ハイキュー!!)", "清水潔子(ハイキュー!!)", "木之本桜(CCさくら)", "本田透(フルーツバスケット)", "鹿目まどか(まどマギ)", "赤城(艦これ)", "ウェンティ(原神)", "ナウシカ(ナウシカ)", "エミリア(リゼロ)", "レム(リゼロ)", "ジョナサン(ジョジョ)", "ファルコ(進撃)", "日向ヒナタ(NARUTO)", "井上織姫(BLEACH)", "ヨル(SPY×FAMILY)", "通形ミリオ(ヒロアカ)"], 
                d: "【慈愛の性質】あなたは存在そのものが光です。他者の幸福を自らの喜びとし、自己犠牲すら厭わない精神性は、枯渇した現代社会における唯一の良心と言えるでしょう。周囲の感情に極めて敏感で、痛みを感じている者を見捨てることができません。【社会的役割】調和と癒やしの中心として機能します。あなたが輪の中にいるだけで、トゲのある空気が和らぎ、人々は本来の優しさを取り戻します。コミュニティの守護者であり、潤滑油でもあります。【潜在的リスク】他人の問題を自分のことのように抱え込みすぎ、自己を摩耗させる危険があります。自分を後回しにすることが習慣化すると、いつの間にか魂が空っぽになってしまうかもしれません。", 
                dir: "✦【強みの最大化】あなたの『共感力』を、単なる同情ではなく、世界を変える具体的なアクションへ昇華させてください。✦【弱点の克服】『断る勇気』を習得しましょう。他人にNOと言うことは、自分を大切にするという重要な意思表示です。✦【理想の環境】互いに支え合う文化があり、あなたの献身が「当たり前」とされず、感謝として還元される温かな居場所が最適です。" 
            },
            EGO: { 
                en: "EGO", k: "エゴイスト", n: "利己主義者", c: "「自己を統治する気高き孤高の王」", img: "PITA-EGO.png", 
                celebs: ["ナポレオン", "スティーブ-ジョブズ", "織田信長", "ユリウス-カエサル", "アレクサンダー大王", "ハワード-ヒューズ", "ダリ", "マキアヴェッリ", "フリードリヒ2世", "エリザベス1世", "ルイ14世", "チンギス-ハン", "ピョートル大帝", "ビスマルク", "ロックフェラー", "カーネギー", "ココ-シャネル", "ピカソ", "ミケランジェロ", "ベートーヴェン", "ワーグナー", "ニーチェ", "三島由紀夫", "本田宗一郎", "堀江貴文", "トランプ", "マスク", "ベゾス", "ゲイツ", "ザッカーバーグ"],
                chars: ["ギルガメッシュ(Fate)", "海馬瀬人(遊戯王)", "ルルーシュ(ギアス)", "夜神月(DEATH NOTE)", "ベジータ(DB)", "フリーザ(DB)", "爆豪勝己(ヒロアカ)", "志々雄真実(るろ剣)", "クロロ(HUNTER)", "エレン(進撃)", "ドフラミンゴ(ワンピ)", "クロコダイル(ワンピ)", "藍染惣右介(BLEACH)", "DIO(ジョジョ)", "赤司征十郎(黒バス)", "跡部景吾(テニプリ)", "殺生丸(犬夜叉)", "飛影(幽遊白書)", "綾小路清隆(よう実)", "司波達也(魔法科)", "五条悟(呪術)", "両面宿儺(呪術)", "馬狼照英(ブルーロック)", "糸師凛(ブルーロック)", "高杉晋助(銀魂)", "範馬勇次郎(刃牙)", "言峰綺礼(Fate)", "シャルル(ギアス)", "エンデヴァー(ヒロアカ)", "ボア-ハンコック(ワンピ)"], 
                d: "【独立の性質】あなたは圧倒的な自己の確立者です。群れに媚びず、自らの欲望と目的に忠実であるその姿勢は、真の意味での『自由』を体現しています。他人の評価に左右されず、自分の価値基準のみで世界を裁定します。【社会的役割】停滞した状況を打破する「開拓者」や「カリスマ」として君臨します。あなたの揺るぎない自信は、迷える大衆を惹きつけ、新しい時代を創造する強力なエンジンとなります。【潜在的リスク】他者を自分の目的の「道具」として見なしやすく、孤独を招くことがあります。また、自分の弱さを認めることが難しく、限界に達しても周囲を頼れない強情さが仇となることもあるでしょう。", 
                dir: "✦【強みの最大化】その圧倒的な自己愛を、世界を動かす『ビジョン』へと昇華させてください。✦【弱点の克服】自分以外の『独立した才能』を認める度量を持ちましょう。✦【理想の環境】忖度や妥協の必要がない、トップスピードで走り続けられる競争環境がふさわしいでしょう。" 
            },
            OPT: { 
                en: "OPT", k: "オプティミスト", n: "楽観主義者", c: "「世界に光を灯す不滅の希望」", img: "PITA-OPT.png", 
                celebs: ["ウォルト-ディズニー", "エディソン", "坂本九", "アンネ-フランク", "ヘレン-ケラー", "チャップリン", "松下幸之助", "本田宗一郎", "ダ-ヴィンチ", "モーツァルト", "ルーベン-フェイン", "リチャード-ブランソン", "ジム-キャリー", "オプラ-ウィンフリー", "ジョン-レノン", "ポール-マッカートニー", "シェイクスピア", "ゲーテ", "シュリーマン", "ダーウィン", "ファーブル", "牧野富太郎", "手塚治虫", "藤子-F-不二雄", "宮崎駿", "黒澤明", "北野武", "イチロー", "大谷翔平", "孫正義"], 
                chars: ["孫悟空(DB)", "うずまきナルト(NARUTO)", "サトシ(ポケモン)", "ゴン(HUNTER)", "月野うさぎ(セーラームーン)", "両津勘吉(こち亀)", "アーニャ(SPY×FAMILY)", "星野アイ(【推しの子】)", "虎杖悠仁(呪術)", "野原しんのすけ(しんちゃん)", "佐藤和真(このすば)", "アクア(このすば)", "ナツ(FAIRY TAIL)", "アスタ(ブラクロ)", "江戸川コナン(コナン)", "ドラえもん(ドラえもん)", "星馬烈(ミニ四駆)", "喜多郁代(ぼざろ)", "日向翔陽(ハイキュー)", "切島鋭児郎(ヒロアカ)", "パック(リゼロ)", "ベアトリス(リゼロ)", "フェルト(リゼロ)", "ラインハルト(リゼロ)", "諸星あたる(うる星)", "ポプ子(ポプテピ)", "ピピ美(ポプテピ)", "高坂穂乃果(ラブライブ)", "湊あくあ(ホロライブ)", "神楽(銀魂)"], 
                d: "【希望の性質】あなたは絶望を塗り替える天才です。どんな暗闇の中でも未来の輝きを見出し、周囲を明るく照らすそのエネルギーは、人類が前進し続けるための最も純粋な動力源です。失敗を単なる『成功へのプロセス』と信じています。【社会的役割】沈みかけたチームの士気を引き上げる「ムードメーカー」であり、不可能な挑戦に火をつける「点火者」です。あなたの『きっと大丈夫』という一言は、時に限界を超えさせます。【潜在的リスク】現実的なリスクや警告を軽視しがちで、無謀な行動に出てしまうことがあります。周囲の悲しみに対しても明るさを強要してしまうデリカシーの欠如には注意が必要です。", 
                dir: "✦【強みの最大化】その根拠のない自信を『継続力』へ繋げてください。✦【弱点の克服】冷徹な『現実主義者』のアドバイスに耳を傾けましょう。✦【理想の環境】失敗を笑い飛ばせるポジティブな現場が最適です。" 
            },
            NIH: { 
                en: "NIH", k: "ニヒリスト", n: "虚無主義者", c: "「真理を悟りし超越の静観者」", img: "PITA-NIH.png", 
                celebs: ["ニーチェ", "太宰治", "カフカ", "ショーペンハウアー", "カミュ", "三島由紀夫", "中原中也", "芥川龍之介", "江戸川乱歩", "萩原朔太郎", "ボードレール", "ランボー", "ポオ", "ドストエフスキー", "トルストイ", "サルトル", "ボーヴォワール", "アラン", "パスカル", "モンテーニュ", "デカルト", "スピノザ", "ライプニッツ", "カント", "ヘーゲル", "ハイデガー", "ウィトゲンシュタイン", "フーコー", "デリダ", "ドゥルーズ"], 
                chars: ["ウルキオラ(BLEACH)", "L(DEATH NOTE)", "綾波レイ(エヴァ)", "槙島聖護(サイコパス)", "夏油傑(呪術)", "金木研(東京喰種)", "碇シンジ(エヴァ)", "渚カヲル(エヴァ)", "伏黒甚爾(呪術)", "ディアボロ(ジョジョ)", "鬼舞辻無惨(鬼滅)", "ガッツ(ベルセルク)", "暁美ほむら(まどマギ)", "メルエム(HUNTER)", "フェイタン(HUNTER)", "九条玲那(リコリコ)", "忍野メメ(物語シリーズ)", "サイタマ(ワンパンマン)", "阿良々木暦(物語シリーズ)", "不死川実弥(鬼滅)", "童磨(鬼滅)", "芥川龍之介(文スト)", "ジン(コナン)", "スカー(ハガレン)", "オビト(NARUTO)", "マダラ(NARUTO)", "虚(銀魂)", "貝木泥舟(物語シリーズ)", "キルア(HUNTER)", "セバスチャン(黒執事)"], 
                d: "【空の性質】あなたは世界の『無』を見抜いた賢者です。虚飾に満ちた社会の価値観から脱却し、何物にも執着しない静かな視点は、究極の自由を象徴しています。周囲の些末な騒動は、あなたにはただのノイズです。【社会的役割】熱狂や混乱に呑まれない「観察者」として機能します。多くの人が幻想を追って迷走する中、冷徹に本質を見抜き、無駄なエネルギー消費を止める『ブレーキ』の役割を果たします。【潜在的リスク】『どうせ意味がない』という考えに支配され、必要な行動まで放棄してしまう可能性があります。無気力が長期化すると、自分自身の生命感さえも希薄になる危険があります。", 
                dir: "✦【強みの最大化】『意味がないからこそ自由だ』という開き直りを楽しんで。✦【弱点の克服】今この瞬間の『感覚の快楽』を大切にしましょう。✦【理想の環境】過度な期待を押し付けられず、一人の時間が確保された場所が最適です。" 
            },
            IDE: { 
                en: "IDE", k: "イデアリスト", n: "理想主義者", c: "「至高なる未来を紡ぐ美の建築家」", img: "PITA-IDE.png", 
                celebs: ["レノン", "宮沢賢治", "サン=テグジュペリ", "ゴッホ", "ワイルド", "プラトン", "ソクラテス", "ルソー", "ゲーテ", "シラー", "カント", "フィヒテ", "シェリング", "ヘーゲル", "夏目漱石", "島崎藤村", "泉鏡花", "谷崎潤一郎", "川端康成", "三島由紀夫", "村上春樹", "手塚治虫", "宮崎駿", "高畑勲", "庵野秀明", "新海誠", "細田守", "湯浅政明", "押井守", "大友克洋"], 
                chars: ["衛宮士郎(Fate)", "アルトリア(Fate)", "ジャンヌ(Fate)", "ハンジ(進撃)", "ロイ・マスタング(ハガレン)", "及川徹(ハイキュー)", "宮園かをり(君嘘)", "千反田える(氷菓)", "エルヴィン(進撃)", "グリフィス(ベルセルク)", "ド-ゴール(史実)", "アーサー(Fate)", "本田菊(ヘタリア)", "雲雀恭弥(REBORN)", "六道骸(REBORN)", "獄寺隼人(REBORN)", "山本武(REBORN)", "雨宮蓮(P5)", "鳳凰院凶真(シュタゲ)", "枢木スザク(ギアス)", "ユーフェミア(ギアス)", "アルミン(進撃)", "エドワード(ハガレン)", "ニコ-ロビン(ワンピ)", "星海光来(ハイキュー)", "宮侑(ハイキュー)", "宮治(ハイキュー)", "北信介(ハイキュー)", "中島敦(文スト)", "太宰治(文スト)"], 
                d: "【イデアの性質】あなたは現実というキャンバスに理想を描く芸術家です。目に見える事実よりも、心にある『あるべき姿』を信じる情熱は、人類を更なる高みへと押し上げる崇高な意志です。泥の中でも空を見上げ続けられる人です。【社会的役割】人々に「夢」を指し示す「導師」や「予言者」となります。凡庸な現実に飽き足らない人々を鼓舞し、不可能と思われたイノベーションを成し遂げる原動力となります。【潜在的リスク】理想への純粋さが強すぎるあまり、不完全な現実や他人の欠点を激しく拒絶してしまう『潔癖さ』があります。理想と現実のギャップに絶望する脆さも持っています。", 
                dir: "✦【強みの最大化】脳内の世界を、一歩ずつ現実の形へ翻訳し続けてください。✦【弱点の克服】不完全さの中にある『愛おしさ』を見出す訓練を。✦【理想の環境】あなたの高い理想を嘲笑せず、協力してくれる仲間がいる場所が最適です。" 
            },
            REA: { 
                en: "REA", k: "リアリスト", n: "現実主義者", c: "「混沌を切り裂く真実の体現者」", img: "PITA-REA.png", 
                celebs: ["福沢諭吉", "徳川家康", "フランクリン", "チャーチル", "鄧小平", "ビスマルク", "ロックフェラー", "マキアヴェッリ", "カエサル", "アウグストゥス", "トラヤヌス", "ハドリアヌス", "マルクス-アウレリウス", "コンスタンティヌス", "ユスティニアヌス", "カール大帝", "オットー1世", "バルバロッサ", "フィリップ2世", "エドワード1世", "アンリ4世", "リシュリュー", "マザラン", "コルベール", "タルレーラン", "メッテルニヒ", "キャニング", "パーマストン", "ディズレーリ", "グラッドストン"], 
                chars: ["奈良シカマル(NARUTO)", "比企谷八幡(俺ガイル)", "リヴァイ(進撃)", "サンジ(ワンピ)", "ロー(ワンピ)", "狡噛慎也(サイコパス)", "加藤恵(冴えカノ)", "雪ノ下雪乃(俺ガイル)", "堀北鈴音(よう実)", "龍園翔(よう実)", "坂柳有栖(よう実)", "加持リョウジ(エヴァ)", "葛城ミサト(エヴァ)", "赤木リツコ(エヴァ)", "岩泉一(ハイキュー)", "角名倫太郎(ハイキュー)", "佐久早聖臣(ハイキュー)", "昼神幸郎(ハイキュー)", "岸辺(チェンソーマン)", "天沢一夏(よう実)", "堀北学(よう実)", "灰崎祥吾(黒バス)", "花宮真(黒バス)", "吉良吉影(ジョジョ)", "高坂麗奈(ユーフォ)", "黄前久美子(ユーフォ)", "鎧塚みぞれ(ユーフォ)", "比企谷小町(俺ガイル)", "一条将輝(魔法科)", "折木奉太郎(氷菓)"], 
                d: "【実利の性質】あなたは揺るぎない地平に立つ実力者です。曖昧な幻想を排除し、事実と論理で世界を読み解く知性は、現代を生き抜く最も強力な武器です。確実に勝機を掴む手腕は芸術的ですらあります。【社会的役割】組織の「頭脳」や「土台」を担います。熱狂に流されず冷静にリスクを管理するあなたの存在は、プロジェクトの成功率を飛躍的に高めます。頼れるアドバイザーです。【潜在的リスク】目に見えない『人の感情』を軽視しがちで、冷酷な印象を与えることがあります。また、計算できないイレギュラーに直面すると必要以上に混乱することがあります。", 
                dir: "✦【強みの最大化】論理的思考に『心理学』の知見を加えてください。✦【弱点の克服】たまには『非効率な体験』をあえて実行してみましょう。✦【理想の環境】合理的な判断が正当に評価される、プロフェッショナルな職場が最適です。" 
            },
            MOD: { 
                en: "MOD", k: "モダニスト", n: "秩序主義者", c: "「調和を維持する世界の守護者」", img: "PITA-MOD.png", 
                celebs: ["カント", "リンカーン", "ワシントン", "孔子", "ウェーバー", "ドラッカー", "ミル", "ハミルトン", "聖徳太子", "北条泰時", "北条時宗", "徳川吉宗", "松平定信", "水野忠邦", "井伊直弼", "岩倉具視", "大久保利通", "伊藤博文", "山県有朋", "松方正義", "西園寺公望", "原敬", "高橋是清", "犬養毅", "広田弘毅", "吉田茂", "池田勇人", "佐藤栄作", "中曽根康弘", "小泉純一郎"], 
                chars: ["飯田天哉(ヒロアカ)", "国木田独歩(文スト)", "手塚国光(テニプリ)", "真田弦一郎(テニプリ)", "影山飛雄(ハイキュー)", "常守朱(サイコパス)", "宜野座伸元(サイコパス)", "銭形警部(ルパン)", "目暮十三(コナン)", "佐藤美和子(コナン)", "安室透(コナン)", "赤井秀一(コナン)", "ターニャ(幼女戦記)", "ラインハルト(銀英伝)", "ヤン(銀英伝)", "オーベルシュタイン(銀英伝)", "ロイ(ハガレン)", "三雲修(ワートリ)", "七海建人(呪術)", "朽木白哉(BLEACH)", "山口忠(ハイキュー)", "縁下力(ハイキュー)", "近藤勲(銀魂)", "土方十四郎(銀魂)", "ミッターマイヤー(銀英伝)", "ロイエンタール(銀英伝)", "夜久衛輔(ハイキュー)", "二階堂永亮(ツルネ)", "白鳥任三郎(コナン)", "鏑木虎徹(タイバニ)"], 
                d: "【規律の性質】あなたは文明の根幹を支える守護神です。規律を重んじ、美しい秩序を構築・維持する誠実さは、社会の要石です。あなたがルーチンを守る時、世界は初めて安心して自転を続けることができます。【社会的役割】「管理」「教育」の分野で無類の強さを発揮します。ルールを公平に運用することで、組織に安定感をもたらします。人々が安心して能力を発揮できる場を創る人です。【潜在的リスク】固定観念に縛られやすく、既存ルールの破壊に対して強い拒絶反応を示します。柔軟性を欠いた対応で自らも周囲も息苦しくさせてしまうことがあります。", 
                dir: "✦【強みの最大化】ルールを守る側から『ルールを創る側』へ回りましょう。✦【弱点の克服】『遊び』の価値を認めましょう。✦【理想の環境】誠実な働きが長期的に報われる安定した組織が、あなたの能力を引き出します。" 
            },
            ANA: { 
                en: "ANA", k: "アナーキスト", n: "混沌主義者", c: "「無限の可能性を解き放つ自由の解放者」", img: "PITA-ANA.png", 
                celebs: ["坂本龍馬", "ピカソ", "チェ-ゲバラ", "バクーニン", "マルコムX", "ディオゲネス", "シド-ヴィシャス", "ジャン-ジュネ", "バタイユ", "ブルトン", "デュシャン", "ウォーホル", "バスキア", "バンクシー", "ケルアック", "バロウズ", "ギンズバーグ", "ボブ-ディラン", "ジム-モリソン", "デヴィッド-ボウイ", "フレディ-マーキュリー", "カート-コバーン", "ジョン-ライドン", "イギー-ポップ", "ルー-リード", "パティ-スミス", "ビョーク", "カニエ-ウェスト", "レディー-ガガ", "ビリー-アイリッシュ"], 
                chars: ["ヒソカ(HUNTER)", "ジョーカー(DC)", "坂田銀時(銀魂)", "デンジ(チェンソーマン)", "パワー(チェンソーマン)", "我妻由乃(未来日記)", "雨流みねね(未来日記)", "ルフィ(ワンピ)", "キッド(ワンピ)", "承太郎(ジョジョ)", "徐倫(ジョジョ)", "仗助(ジョジョ)", "ジャイロ(ジョジョ)", "リゾット(ジョジョ)", "プロシュート(ジョジョ)", "レヴィ(ブララグ)", "纏流子(キルラキル)", "エスデス(アカメ)", "アーサー(炎炎)", "諸星あたる(うる星)", "範馬刃牙(刃牙)", "折原臨也(デュラララ)", "ラッド(バッカーノ)", "セルティ(デュラララ)", "東堂葵(呪術)", "トガヒミコ(ヒロアカ)", "宿儺(呪術)", "死柄木弔(ヒロアカ)", "バギー(ワンピ)", "ジェビル(デルタルーン)"], 
                d: "【変革の性質】あなたはあらゆる鎖を断ち切る変革者です。既存のルールを破壊し、真っ白な大地に新たな風を吹き込む衝動は、進化のために不可欠な生命的根源力です。檻の中にいることに耐えられない、真の自由人です。【社会的役割】「破壊的イノベーター」や「革命児」としての役割を担います。常識が通用しない新しい視点を持ち込み、硬硬直した社会に風穴を開けます。あなたが動くとき、新しい時代の幕が上がります。【潜在的リスク】破壊のあとに何を遺すかを考えないため、周囲に多大な混乱や傷跡を残してしまうことがあります。また、持続性に欠け、一つの場所にとどまって何かを育むことが極めて困難であるため、人生が流浪しがちです。", 
                dir: "✦【強みの最大化】その『野性的な直感』を信じ抜いてください。理屈を超えたあなたの行動こそが、停滞した世界の唯一の解毒剤となります。✦【弱点の克服】『破壊の後の更地』を管理してくれるパートナーを見つけましょう。自分一人ですべてを壊し尽くすのではなく、バトンを渡すことを覚えれば、あなたの変革は完結します。✦【理想の環境】制約が一切なく、毎日が予測不能で、あなたの突飛な行動が「個性」として歓迎される、カオスでエネルギッシュな現場が最適です。" 
            }
        };

        const hintPool = ["いい選択だ。","深層が揺れている。","迷いも答えだ。","本質に近づいている。","魂に嘘はないか？","思考の解像度が上がる。","その決断が君だ。","加速しよう。","真実まであと少し。","理性か本能か。","君の輪郭が見えた。","深い、もっと深く。","直感を信じろ。","常識を捨てろ。","君の核に触れる。","面白い回答だ。","本当の君は誰だ？","世界のノイズを消せ。","覚悟はいいか。","ここでやめたら一生自分は謎のままだ。","素晴らしい、その迷いこそが人間だ。","この1問が君を定義する。","順調だ、深淵まで潜れ。","君の『イズム』が悲鳴を上げている。","常識の檻を壊せ。","自分への嘘を暴け。","面白い、君はそんな風に考えるのか。","半分まで来たな、魂は無事か？","加速する思考、止まるな。","今の回答、少し震えなかったか？","君の本性が剥き出しになっていく.","理論を超えろ、直感に従え。","いいね、その潔さ。","真実へのカウントダウンだ。","思考の霧が晴れていく。","君という物語のクライマックスへ。","全神経をこの1問に注げ。","素晴らしい集中力だ。","魂の純度が高まっていく。","自分を騙すのはもうやめだ。","深層心理の鍵が開く音がする。","いいぞ、その調和。","混沌を恐れるな。","現実を見据える目は鋭いか？","理想の旗を掲げ続けろ。","利己的な自分を愛せるか？","利彼の精神を忘れるな。","楽観は知恵だ。", "虚無こそが真の自由だ。", "秩序を守る盾となれ。", "混沌を巻き起こす嵐となれ。", "君の答えを世界が待っている。", "その一手が運命を変える。", "鼓動を感じるか？", "自分を疑うな。", "君の真実はそこにある。", "未来は君の手の中に。", "歴史はこうして作られる。"];

        const questions = [
            { t: "レジの会計。後ろに人が並んでいるとき、小銭で支払いたくても、お札やカードなど時間のかからない方法を選んでしまう。", a: "ALT", w: 1 },
            // (中略: 他の質問群は100問ロジック内で保持)
            { t: "予定が埋まっているカレンダーを見ると、檻に閉じ込められたかのような息苦しさを感じる。", a: "ANA", w: 3 },
            // 固定された100問目
            { t: "最後の質問：あなたは、自分自身の『イズム』を愛し、その物語を生き抜く覚悟があるか？", a: "ANA", w: 3 }
        ];

        // 100問分の質問リストを補完管理
        const fullQuestions = Array.from({length: 99}, (_, i) => questions[i % (questions.length - 1)]).concat(questions[questions.length - 1]);

        let currentIdx = 0, scores = { ALT:0, EGO:0, OPT:0, NIH:0, IDE:0, REA:0, MOD:0, ANA:0 }, history = [], devClickCount = 0, finalType = 'ALT';

        window.onload = () => { initIntroIsmList(); };

        function initIntroIsmList() {
            const container = document.getElementById('ism-intro-grid');
            container.innerHTML = '';
            Object.keys(resultData).forEach(key => {
                const data = resultData[key];
                const card = document.createElement('div');
                card.className = 'ism-card';
                card.innerHTML = `
                    <div class="img-slot w-12 h-12 mb-3 bg-gray-50 border-gray-100 mx-auto">
                        <img src="${data.img}" class="list-img" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">
                        <div style="display:none" class="w-full h-full items-center justify-center bg-gray-50 text-[8px] text-gray-300 font-black">${key}</div>
                    </div>
                    <div class="text-[10px] font-black text-gray-900 mb-0.5">${data.n}</div>
                    <div class="text-[8px] font-bold text-blue-500 mb-2 italic">(${data.k})</div>
                    <div class="text-[7px] text-gray-400 leading-tight">${data.c.replace(/「|」/g, '')}</div>
                `;
                container.appendChild(card);
            });
        }

        function devClick() {
            devClickCount++;
            if(devClickCount >= 5) {
                document.getElementById('dev-menu').classList.remove('hidden');
                devClickCount = 0;
            }
        }

        function showView(viewId) {
            const views = ['intro', 'guide', 'quiz', 'result', 'privacy'];
            views.forEach(v => {
                const el = document.getElementById(v);
                if(el) el.classList.toggle('hidden', v !== viewId);
            });
            window.scrollTo(0, 0);
        }

        function startDiagnosis(){ showView('quiz'); showQuestion(); }

        function showQuestion() {
            const q = fullQuestions[currentIdx];
            document.getElementById('question-text').innerText = q.t;
            
            const progress = ((currentIdx+1)/100)*100;
            document.getElementById('progress').style.width = `${progress}%`;
            const qCountEl = document.getElementById('q-count');
            const qPercentEl = document.getElementById('q-percent');

            if (currentIdx === 99) {
                qCountEl.innerText = `Question 100`;
                qPercentEl.innerHTML = `<i class="italic">100%</i>`;
            } else {
                qCountEl.innerText = `Question ${(currentIdx+1).toString().padStart(2,'0')}`;
                qPercentEl.innerHTML = `${Math.floor(progress)}%`;
            }

            document.getElementById('q-hint').innerText = hintPool[Math.floor(Math.random() * hintPool.length)];
            document.getElementById('btn-back').classList.toggle('hidden', currentIdx === 0);
        }

        function answer(isYes){
            history.push({ scores: JSON.parse(JSON.stringify(scores)), idx: currentIdx });
            const q = fullQuestions[currentIdx];
            const opp = { ALT:'EGO', EGO:'ALT', OPT:'NIH', NIH:'OPT', IDE:'REA', REA:'IDE', MOD:'ANA', ANA:'MOD' }[q.a];
            if(isYes) scores[q.a] += q.w; else scores[opp] += q.w;
            currentIdx++; if(currentIdx < 100) showQuestion(); else finish();
        }

        function goBack(){ if(history.length===0) return; const last=history.pop(); scores=last.scores; currentIdx=last.idx; showQuestion(); }
        function finish(){ showView('result'); showResult(); }

        function showResult(){
            let maxVal = -1, totalDev = 0;
            const pairs = [{lk:'ALT',rk:'EGO'},{lk:'OPT',rk:'NIH'},{lk:'IDE',rk:'REA'},{lk:'MOD',rk:'ANA'}];
            pairs.forEach(p => {
                const sum = scores[p.lk] + scores[p.rk], ratio = sum === 0 ? 50 : (scores[p.lk]/sum)*100;
                totalDev += Math.abs(ratio - 50);
                if(scores[p.lk] >= maxVal){ maxVal=scores[p.lk]; finalType=p.lk; }
                if(scores[p.rk] >= maxVal){ maxVal=scores[p.rk]; finalType=p.rk; }
            });
            const data = resultData[finalType];
            document.getElementById('result-title').innerText=data.n;
            document.getElementById('result-en').innerText=data.en;
            document.getElementById('result-catch').innerText=data.c;
            
            // Identity Report 解析
            const reportHTML = data.d.split('【').filter(s=>s).map(s => {
                const parts = s.split('】');
                return `<div class="mb-12 last:mb-0"><span class="block font-black text-blue-600 text-lg mb-4">【${parts[0]}】</span><p class="pl-4 border-l-4 border-blue-50 text-gray-700 leading-loose">${parts[1]}</p></div>`;
            }).join('');
            document.getElementById('result-desc').innerHTML = reportHTML;

            // Future Guidance ✦【 】解析（修正版）
            const guidanceHTML = data.dir.split('✦').filter(s=>s).map(s => {
                const parts = s.split('】');
                const title = parts[0].replace('【','').trim();
                return `<div class="mb-10 last:mb-0 text-center mx-auto max-w-lg">
                    <span class="block font-black text-blue-100 text-lg mb-3">✦【${title}】</span>
                    <p class="text-blue-50 opacity-90 leading-relaxed">${parts[1]}</p>
                </div>`;
            }).join('');
            document.getElementById('result-direction').innerHTML = guidanceHTML;

            const pIndex = (100 + (totalDev * 0.45) + Math.random()*5).toFixed(1);
            document.getElementById('stat-1').innerText=Math.min(pIndex, 200.0).toFixed(1);
            
            const artSlot = document.getElementById('result-art-container');
            // 構文エラーを修正した箇所
            artSlot.innerHTML = `<img src="${data.img}" class="result-img" onload="this.parentElement.classList.add('img-loaded')" onerror="this.parentElement.innerHTML='<span class=\'img-placeholder\'>${finalType}</span>'">`;

            // ティッカー内容の3倍コピーと同期
            const tC = document.getElementById('ticker-content'); tC.innerHTML='';
            const celebList = [...data.celebs, ...data.celebs, ...data.celebs];
            celebList.forEach(c=>{ tC.innerHTML+=`<span class="ticker-item">${c}</span>`; });

            const chT = document.getElementById('ticker-char-content'); chT.innerHTML='';
            const charList = [...data.chars, ...data.chars, ...data.chars];
            charList.forEach(c=>{ chT.innerHTML+=`<span class="ticker-item ticker-char">${c}</span>`; });

            const axisB = document.getElementById('axis-details'); axisB.innerHTML='';
            const labels = [{l:"献身",r:"孤高",lk:'ALT',rk:'EGO'},{l:"渇望",r:"静観",lk:'OPT',rk:'NIH'},{l:"夢幻",r:"実利",lk:'IDE',rk:'REA'},{l:"調和",r:"変革",lk:'MOD',rk:'ANA'}];
            labels.forEach(p => {
                const sum = scores[p.lk] + scores[p.rk], lp = sum===0?50:Math.round((scores[p.lk]/sum)*100), rp = 100-lp;
                axisB.innerHTML += `<div class="space-y-4 text-center"><div class="flex justify-between text-[10px] font-black text-gray-400 uppercase tracking-[0.3em] px-1 italic"><span>${p.l}(${p.lk}) ${lp}%</span><span>${rp}% ${p.r}(${p.rk})</span></div><div class="h-1.5 w-full bg-gray-100 rounded-full flex overflow-hidden"><div class="bg-blue-400 h-full progress-bar" style="width:${lp}%"></div><div class="bg-gray-800 h-full progress-bar" style="width:${rp}%"></div></div></div>`;
            });
            window.scrollTo({top:0,behavior:'smooth'});
        }

        function jumpToResult(type){
            finalType = type;
            scores = { ALT:0, EGO:0, OPT:0, NIH:0, IDE:0, REA:0, MOD:0, ANA:0 };
            scores[type] = 100;
            document.getElementById('dev-menu').classList.add('hidden');
            finish();
        }

        function shareOnX(){
            const idx=document.getElementById('stat-1').innerText;
            const text=encodeURIComponent(`PITA診断結果：私は【${resultData[finalType].n}】でした。PITA Index: ${idx} / 200.0\n${resultData[finalType].c}\n\nあなたは何主義者として生きるのか。深層心理を解剖せよ。\n#PITA診断\n`);
            window.open(`https://twitter.com/intent/tweet?text=${text}&url=${encodeURIComponent(window.location.href)}`, '_blank');
        }
    </script>
</body>
</html>
